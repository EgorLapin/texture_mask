# Анализ текстур с использованием GLCM и создание маски

Этот проект представляет собой решение задачи выделения текстурной области изображения с использованием матрицы совместного появления уровней серого (GLCM). Основной скрипт использует модуль `GLCM_analysis.py` для анализа текстуры и создания бинарной маски на основе локального контраста.

## Описание

Скрипт выполняет следующие шаги:
1. **Создание составного изображения**: Комбинирует текстуру кирпичной стены (`skimage.data.brick()`) с однородным фоном (значение серого 128).
2. **Вычисление глобальных признаков**: Использует модуль `GLCM_analysis.py` для вычисления контраста, энергии и однородности для текстурной и однородной частей изображения.
3. **Вычисление локального контраста**: Применяет скользящее окно для создания карты локального контраста с использованием GLCM.
4. **Создание бинарной маски**: Устанавливает порог контраста как среднее между глобальными значениями контраста текстурной и однородной областей. Пиксели с контрастом выше порога получают значение 1, остальные — 0.
5. **Применение маски**: Накладывает бинарную маску на исходное изображение, выделяя текстурные области.
6. **Отображение результатов**: Показывает четыре изображения (составное изображение, карта контраста, бинарная маска, маскированное изображение) в одном окне.

## Требования

- Python 3.6+
- Библиотеки:
  - `numpy`
  - `matplotlib`
  - `scikit-image`
- Модуль `GLCM_analysis.py` (должен находиться в той же директории)

Установите зависимости с помощью:
```bash
pip install numpy matplotlib scikit-image
```

## Использование

1. Убедитесь, что файл `GLCM_analysis.py` находится в той же директории, что и основной скрипт.
2. Запустите скрипт `texture_mask.py`:
   ```bash
   python texture_mask.py
   ```
3. Результаты будут выведены в консоль (значение порога) и отображены в окне matplotlib с четырьмя изображениями.

## Структура файлов

- `GLCM_analysis.py`: Модуль для загрузки изображений, вычисления GLCM и извлечения признаков текстуры (контраст, энергия, однородность).
- `texture_mask.py`: Основной скрипт, реализующий задачу создания маски на основе текстуры.
- `README.md`: Этот файл с описанием проекта.
- `requirements.txt`: Используемые библиотеки

## Пример вывода

- **Консоль**: Выводит глобальные признаки текстуры для текстурной и однородной частей, а также значение порога контраста.
- **Графический вывод**: Показывает четыре изображения:
  - Составное изображение (левая половина — текстура кирпича, правая — однородный фон).
  - Карта локального контраста (цветная, с использованием цветовой карты `jet`).
  - Бинарная маска (1 для текстурных областей, 0 для однородных).
  - Маскированное изображение (только текстурные области остаются видимыми).

  <img width="1920" height="1080" alt="image" src="https://github.com/user-attachments/assets/6cc55be3-d4aa-40c5-b8ce-ca13bb60eac8" />
Пример вывода для следующих аргументов функции compute_local_contrast:
  gray_img, window_size=5, distances=(1,), angles=(0, np.pi/4, np.pi/2, 3*np.pi/4), levels=256

## Замечания

- Размер скользящего окна (`window_size=21`) и параметры GLCM (расстояния и углы) можно настроить в функции `compute_local_contrast`.
- Порог контраста вычисляется как среднее между глобальными контрастами текстурной и однородной областей. Это можно модифицировать для других задач.
- Для улучшения качества маски можно экспериментировать с другими метриками GLCM (например, энергией или корреляцией) или с другими пороговыми значениями.

## Ограничения

- Код предполагает, что изображение `brick` из `skimage.data` доступно.
- Обработка больших изображений может быть медленной из-за вычислений GLCM в скользящем окне.
- Ошибки обрабатываются с выводом сообщений в консоль, но для критических приложений рекомендуется добавить дополнительную обработку.
